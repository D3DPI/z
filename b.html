<!DOCTYPE html>
<html>
<script src="aframe.min.js"></script>
<script src="aframe-ar.js"></script>
<body style="margin : 0px; overflow: hidden;">
  <a-scene embedded arjs>
    <a-marker preset="hiro">
      <a-entity
        position="0 0 0"
        scale="0.05 0.05 0.05"
        gltf-model="model1.gltf"
      ></a-entity>
    </a-marker>

    <a-marker type="pattern" url="pattern2.patt">
      <a-entity
        position="0 0 0"
        scale="0.05 0.05 0.05"
        gltf-model="model2.gltf"
      ></a-entity>
    </a-marker>

    <a-entity camera></a-entity>
  </a-scene>

  <div id="infoText" style="position: fixed; top: 10px; left: 10px; background-color: rgba(0,0,0,0.7); color: white; padding: 10px; border-radius: 5px; z-index: 9999;">
    Scan a marker to display information
  </div>

  <button id="playButton" style="position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%); padding: 10px 20px; font-size: 18px; background-color: #4CAF50; color: white; border: none; border-radius: 5px; cursor: pointer; z-index: 9999; display: none;">
    Play Audio
  </button>

  <audio id="audio1" src="audio1.mp3"></audio>
  <audio id="audio2" src="audio2.mp3"></audio>

  <script>
    const infoText = document.getElementById('infoText');
    const playButton = document.getElementById('playButton');
    const audio1 = document.getElementById('audio1');
    const audio2 = document.getElementById('audio2');
    let currentAudio = null;

    function loadTextFile(url, callback) {
      fetch(url)
        .then(response => response.text())
        .then(text => callback(text))
        .catch(error => console.error('Error loading text file:', error));
    }

    AFRAME.registerComponent('marker-handler', {
      init: function () {
        this.el.addEventListener('markerFound', () => {
          const markerId = this.el.id;
          if (markerId === 'marker1') {
            currentAudio = audio1;
            loadTextFile('info1.txt', text => infoText.textContent = text);
          } else if (markerId === 'marker2') {
            currentAudio = audio2;
            loadTextFile('info2.txt', text => infoText.textContent = text);
          }
          playButton.style.display = 'block';
        });

        this.el.addEventListener('markerLost', () => {
          infoText.textContent = 'Scan a marker to display information';
          playButton.style.display = 'none';
          if (currentAudio) {
            currentAudio.pause();
            currentAudio.currentTime = 0;
          }
          currentAudio = null;
        });
      }
    });

    playButton.addEventListener('click', () => {
      if (currentAudio) {
        currentAudio.play();
      }
    });

    document.addEventListener('DOMContentLoaded', () => {
      const markers = document.querySelectorAll('a-marker');
      markers.forEach((marker, index) => {
        marker.setAttribute('marker-handler', '');
        marker.id = `marker${index + 1}`;
      });
    });
  </script>
</body>
</html>
